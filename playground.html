<!DOCTYPE html>
<html>
    <head>
        <title>6 Example Trials</title>
        <!-- <script src="jatos.js"></script> -->
        <script src="./jspsych-6.1.0/jspsych.js"></script>        
        <script src="./extra_functions/lodash.js"></script>
        <script src = "./extra_functions/jquery-3.4.1.js" type="text/javascript"></script>
        <!-- <script src="extra_functions/jspsych-html-slider-response-smooth-tracking.js"></script>
        <script src="./extra_functions/custom_functions.js"> </script> -->
        <script src="./extra_functions/jspsych-plugin-playground.js"></script>
        <script src="./extra_functions/jspsych-free-sort-modified.js"></script>        
        <link href="./jspsych-6.1.0/css/jspsych.css" rel="stylesheet" type="text/css"></link>
    </head>
    <body></body>
    <script>

    // ////////////////////////////////////////////////////////////////////////////////////////////
    // ///////////////////////////////////////////////////////////////////////////////////////////

        var baseTrialArray = [
            {item1: "T1", item2: "T2"},
            {item1: "T1", item2: "T3"},
            {item1: "T1", item2: "E1"},
            {item1: "T1", item2: "E2"},
            {item1: "T1", item2: "E3"},
            {item1: "T1", item2: "E4"},
            {item1: "T1", item2: "E5"},
            {item1: "T1", item2: "E6"},
            {item1: "T1", item2: "E7"},
            {item1: "T1", item2: "E8"},
            {item1: "T1", item2: "E9"},
            {item1: "T1", item2: "E10"},
            {item1: "T1", item2: "E11"},
            {item1: "T1", item2: "E12"},
            {item1: "T1", item2: "E13"},
            {item1: "T2", item2: "T3"},
            {item1: "T2", item2: "E1"},
            {item1: "T2", item2: "E2"},
            {item1: "T2", item2: "E3"},
            {item1: "T2", item2: "E4"},
            {item1: "T2", item2: "E5"},
            {item1: "T2", item2: "E6"},
            {item1: "T2", item2: "E7"},
            {item1: "T2", item2: "E8"},
            {item1: "T2", item2: "E9"},
            {item1: "T2", item2: "E10"},
            {item1: "T2", item2: "E11"},
            {item1: "T2", item2: "E12"},
            {item1: "T2", item2: "E13"},
            {item1: "T3", item2: "E1"},
            {item1: "T3", item2: "E2"},
            {item1: "T3", item2: "E3"},
            {item1: "T3", item2: "E4"},
            {item1: "T3", item2: "E5"},
            {item1: "T3", item2: "E6"},
            {item1: "T3", item2: "E7"},
            {item1: "T3", item2: "E8"},
            {item1: "T3", item2: "E9"},
            {item1: "T3", item2: "E10"},
            {item1: "T3", item2: "E11"},
            {item1: "T3", item2: "E12"},
            {item1: "T3", item2: "E13"}
        ]

        // Just an array with names of empties
        var allEmptyNames = ["E1","E2","E3","E4","E5","E6","E7","E8","E9","E10","E11","E12","E13","E14","E15","E16"]

        // Now, allocate coordinates for all empty location
        var targetCoords = {
            targetNames: JSON.parse(JSON.stringify(allEmptyNames)),
            imageNames: Array(16).fill("Empty"),
            xCoord: [],
            yCoord: []
        }

        for (iX = 0; iX < 4; iX++){

            for (iY = 0; iY < 4; iY++){

                targetCoords.xCoord.push(iX * 50 + 100);
                targetCoords.yCoord.push(iY * 50 + 100);                
            }
        }
        
        var targetToImages = {  
            targetIdx: ["T1","T2","T3","E1","E2","E3","E4","E5","E6","E7","E8","E9","E10","E11","E12","E13"],
            targetImg: ["Bell","Tree","Santa","Empty","Empty","Empty",
                        "Empty","Empty","Empty","Empty","Empty",
                        "Empty","Empty","Empty","Empty","Empty"]
        }

        // Now, which ones become the targets?
        var tgt_idxs = [1,7,14] // so 1st, 7th and 14th points

        for (iIdx = 0; iIdx < tgt_idxs.length; iIdx++){

            targetCoords.targetNames[tgt_idxs[iIdx] - 1] = "T" + (iIdx+1)

            // For this target, whats the name of the Christmas toy?
            let i_tgt_name_match = targetToImages.targetImg[targetToImages.targetIdx.indexOf("T" + (iIdx+1))]

            targetCoords.imageNames[tgt_idxs[iIdx] - 1] = i_tgt_name_match

        }


        // // Create an array signifying which item is the target? Which toy to display?
        // var tempArray = []
        // for (i=0, j=0; i < baseTrialArray.length / 2; i++, j+=2){

        //     if(j % 2 == 0){
        //         tempArray[i] = 1
        //     } else {
        //         tempArray[i] = 2
        //     }
        // }

        // Add which of the items are shown on the top (or left)
        for(i = 0; i < baseTrialArray.length; i++) {

            // Which item is on top or left?
            if (i % 2 == 1){
                baseTrialArray[i].item_on_top_or_left = 2
                baseTrialArray[i].target_item_idx = 2                
            } else {
                baseTrialArray[i].item_on_top_or_left = 1
                baseTrialArray[i].target_item_idx = 1                
            }

            // debugger

            // Name of the target toy item?
            let targetID = baseTrialArray[i]["item" + baseTrialArray[i].target_item_idx]
            let targetName = targetToImages.targetImg[targetToImages.targetIdx.indexOf(targetID)]



        }

        // debugger

        // var targetCoords = {
        //     targetIdx: ["T1","T2","T3","E1","E2","E3","E4","E5","E6","E7","E8","E9","E10","E11","E12","E13"],
        //     xCoord: [],
        //     yCoord: []
        // }
        // // possibly: 
        // var targetCoords = {
        //     T1: {xCoord: 10, yCoord: 10},
        //     T2: {xCoord: 20, yCoord: 20}
        // }

        // ///////////////////////////////////////////////////////////////////////////////////////////////
        // For each concept, create the arrays for each trial, specifying which image is loaded with what dimensions and where.

        var curr_space = "neck_legs_space"

        var neck_legs_space_parameters = {
            parts: ["Body","Feet","Head","Legs","Neck"],
            xDimName: "Neck",
            yDimName: "Legs",
            stim1_x_coords: [200,250],
            stim1_y_coords: [300,250],
            stim2_x_coords: [300],
            stim2_y_coords: [300],
            stim_width: [200,50,30,30,20],
            stim_height: [100,50,30,20,20],
            xDim_height: [100], // neck
            yDim_height: [100] // legs
        }

        // debugger

        // Now create image paths from names
        var imagePaths = neck_legs_space_parameters.parts.map(function(item){
            let path = "./img/" + curr_space + "/birdparts/" + item + ".png"
            return path
        })

        ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


        // //////////// FREE SORT PLUGIN //////////////////////////////

        var timeline = [];

        var target_stimulus = ["./img/targets/Bell.png"]

        var sort_trial = {
            type: 'plugin-playground',
            target_stimulus: target_stimulus,
            target_stim_width: 50,
            target_stim_height: 50,
            target_stim_x_coords: 350,
            target_stim_y_coords: 50,
            sort_area_width: 750,
            sort_area_height: 700,
            prompt: "Which OFFFF of the two pictures below are associated with this Christmas toy?",
            choices: ['1', '2'],
            // trial_duration: 2000,
            response_ends_trial: true              
        };

        timeline.push(sort_trial)

        jsPsych.init({
            timeline: timeline
        });


        // ///////////////////////////////////////////////////////////////////////////////////////////////
        //////////////////////////////////////////////////////////////////////////////////////////////////

    </script>
</html>
